治病流程与诊断率和治疗率
==============================================================================

.. contents:: 目录
    :local:

参考资料:

- 疾病诊断治疗概率: https://www.gamersky.com/handbook/201811/1127347.shtml
- 关于诊断率和治疗率的计算公式，来自反编译源码: http://dq.tieba.com/p/5885314076


治愈率
------------------------------------------------------------------------------

**变量**:

- 治疗成功率:
- 诊断率: 整个诊断过程积累的诊断率, 最高 100%
- 疾病难度: 取决于疾病难度
- 员工治疗技能: 例如 ``治疗5`` 能增加 50% 的治疗率
- 房间加成: 例如升级过 3 次机器的 ``药房3`` 能增加 50% 的治疗率
- 最小治疗成功率: 取决于疾病难度
- 最大治疗成功率: 取决于疾病种类, 有些疾病最大治疗成功率就无法达到 100%, 所以无论怎样都有可能治疗失败

**公式**:

- 治疗成功率 = 诊断率 x ( 最小成功率 + ( 最大成功率 - 最小成功率 ) x ( min(100%, 员工治疗技能 + 房间加成) )
- 最小治疗成功率 = 100% - 疾病难度
- 房间加成 = 显示的 升级 数值 * 0.5

**例子**:

- 条件: 诊断率 100%, 疾病难度 60%, 最大治疗成功率 100%, 医生技能 50% (5 级治疗), 界面显示房间加成 50% (升级了 2 次的药房)
- 计算:
    - 最小治疗成功率 = 100% - 60% = 40%
    - 房间加成 = 50% x 0.5 = 25%
    - 医生技能 + 房间加成 = 50% + 25% = 75%
    - 治疗成功率 = 100% x ( 40% + ( 100% - 40% ) * min(100%, 75%) ) = 85%

**结论**:

- 员工治疗技能 + 房间加成 无法超过 100%, 所以房间内的 治疗加成物品摆放的数量可以根据
    - 员工 5 级治疗 (+50%) 和 房间 3 级机械 (+50%) 情况下, 物品需要提供 25% 的加成才能达到 100%
    - 员工 5 级治疗, 物品需要提供 50% 的加成才能达到 100%
    - 房间 3 级机械, 物品需要提供 75% 的加成才能达到 100%
    - 什么都没有, 物品需要提供 100% 的加成


诊断率
------------------------------------------------------------------------------

**变量**:

- 最终诊断率: 由所有诊断流程中经过的房间叠加而成. 最高 100%.
- 基础诊断率: 某个疾病 在某个房间 的基础诊断率为固定值, 具体值需要查 :ref:`疾病的诊断和治疗数据`, 最低 10%, 最高 100%.
- 房间加成: 诊疗室内的仪器升级的加成, 例如升级两次的综合诊断能提供 50% 的加成, 房间加成就为 1 + 50% = 150%.
- 物品加成: 房间内的物品加成, 例如药柜. 假如有 50个药柜, 那么物品加成就为 1 + 50% = 150%
- 重访加成: 第二次返回全科诊断室的加成, 由疾病决定, 具体值需要查表, 最低 5%
- 员工诊断技能: 员工的诊断技能, 由员工等级和员工技能共同决定, 例如医生和护士的1 级初始诊断技能为 80%, 5 级员工为 120%, 5 级诊断能再提高 50%.

**公式**:

- 最终诊断率 = 基础诊断率 * 房间加成 * 物品加成 * 返诊加成 * 研究加成 * 员工诊断技能

**例子**:

以难度中上的疾病患有 ``国王情节`` 的患者到医院就诊, 首先看看在 **最基础的情况下, 医生护士都为 1 级, 且没有物品加成, 仪器升级的情况下的诊断值**:

- 首先去全科医生办公室. 1 级无技能医生具有 80％ 的诊断技能, 在上表中, ``全科医生办公室`` 对 ``国王情结`` 的基础诊断率 20％. 所以全科医生办公室提供了: ``20％ x 80％ = 16％`` 的诊断值.
- 患者现在已被确诊 16％, 并被送到具有1级机器的综合诊断室. 在上表中, ``综合诊断室`` 对 ``国王情结`` 的基础诊断率为 12％. 所以综合诊断室提供了: ``12% * 80% = 9.6%``, 此时总诊断值为 ``16% + 9.6% = 25.6%``
- 患者现在已被确诊 25.6％, 并被送回全科医生办公室. 在表格中, 重访加成为10％, 所以重访提供了: ``10% * 80% = 8%`` 的诊断值, 此时总诊断值为 ``25.6% + 8% = 33.6%`` 完全不够看!

现在我们来计算 **医生和诊断室设施 Max 的情况下 (不算堆药柜) 的诊断室**

- 全科办公室第一次访问, 5 级医生 + 5 级全科技能 等于 120% + 75% = 195%. 在上表中, ``全科医生办公室`` 对 ``国王情结`` 的基础诊断率 20％. 所以第一次访问提供了 ``20% * 195% = 39%`` 的诊断率
- 患者前往超级磁力共振诊断室, 3 级机器提供 150% 加成, 5 级医生 + 1 级放射科, 4 级诊断提供了 120% + 40% = 160% 加成, ``超级磁力共振诊断室`` 对 ``国王情结`` 的基础诊断率为 20％. 所以该次访问提供了 ``20% * 150% * 160% = 48%``
- 重访全科办公室, 该次访问提供了: ``10% * 195% = 19.5%``, 此时总诊断值为 ``39% + 48% + 19.5% = 106.5%.

有点感觉了吗?

**结论**:

- 磁力共振诊断室对于除了 DNA 疾病之外的疾病, 诊断率碾压其他诊断室.
- 全科提供的诊断率可以靠夸张的药柜数量直接将第一次诊断结果堆到 100%.


.. _疾病的诊断和治疗数据:

疾病的诊断和治疗数据
------------------------------------------------------------------------------

.. jinja:: doc_data

    {{ doc_data.lt_disease_diagnose_and_treatment.render() }}
