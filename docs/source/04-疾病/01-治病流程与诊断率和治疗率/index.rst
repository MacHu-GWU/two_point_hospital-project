治病流程与诊断率和治疗率
==============================================================================

.. contents:: 目录
    :local:

参考资料:

- 疾病诊断治疗概率: https://www.gamersky.com/handbook/201811/1127347.shtml
- 关于诊断率和治疗率的计算公式，来自反编译源码: http://dq.tieba.com/p/5885314076


治愈率
------------------------------------------------------------------------------

**变量**:

- 治疗成功率:
- 诊断率: 整个诊断过程积累的诊断率, 最高 100%
- 疾病难度: 取决于疾病难度
- 员工治疗技能: 例如 ``治疗5`` 能增加 50% 的治疗率, 员工基础治疗技能请参考 :ref:`员工等级和基础属性`
- 房间加成: 例如升级过 3 次机器的 ``药房3`` 能增加 50% 的治疗率
- 最小治疗成功率: 取决于疾病难度
- 最大治疗成功率: 取决于疾病种类, 有些疾病最大治疗成功率就无法达到 100%, 所以无论怎样都有可能治疗失败

**公式**:

- 治疗成功率 = 诊断率 x ( 最小成功率 + ( 最大成功率 - 最小成功率 ) x ( min(100%, 员工治疗技能 + 房间加成) )
- 最小治疗成功率 = 100% - 疾病难度
- 房间加成 = 显示的 升级 数值 * 0.5
- 解读: 本质上任何疾病难度就是从 最大成功率减去的部分, 而 员工治疗技能 + 房间加成 就是为了抵消疾病难度而存在的, 最高 100%

**例子**:

- 条件: 诊断率 100%, 疾病难度 60%, 最大治疗成功率 100%, 医生技能 100% (5 级治疗 50% 以及 5 级医生 50%), 界面显示房间加成 50% (升级了 2 次的药房)
- 计算:
    - 最小治疗成功率 = 100% - 60% = 40%
    - 房间加成 = 50% x 0.5 = 25%
    - 医生技能 + 房间加成 = 100% + 25% = 125%
    - 治疗成功率 = 100% x ( 40% + ( 100% - 40% ) * min(100%, 125%) ) = 100%

**结论**:

- 对于 诊所类的房间, 员工只需要4 级员工, 4 级治疗即可配合机器升级达到 40% + 40% + 25% > 100% 的满治疗, 多余的一级可以用来学习其他技能
- 对于 诊所类的房间, 3 级员工, 2 级机器, 房间和员工加成为 30% + 30% + 25% = 85%
- 对于 诊所类的房间, 2 级员工, 1 级机器, 房间和员工加成为 20% + 20% + 12.5% = 52.5%
- 对于 诊所类的房间, 1 级员工, 0 级机器, 房间和员工加成为 10% + 10% = 20%
- 需要多少物品来弥补, 自己看着办吧.


诊断率
------------------------------------------------------------------------------

**变量**:

- 最终诊断率: 由所有诊断流程中经过的房间叠加而成. 最高 100%.
- 基础诊断率: 某个疾病 在某个房间 的基础诊断率为固定值, 具体值需要查 :ref:`疾病的诊断和治疗数据`, 最低 10%, 最高 100%.
- 房间加成: 诊疗室内的仪器升级的加成, 例如升级两次的综合诊断能提供 50% 的加成, 房间加成就为 1 + 50% = 150%.
- 物品加成: 房间内的物品加成, 例如药柜. 假如有 50个药柜, 那么物品加成就为 1 + 50% = 150%
- 重访加成: 第二次返回全科诊断室的加成, 由疾病决定, 具体值需要查表, 最低 5%
- 员工诊断技能: 员工的诊断技能, 由员工等级和员工技能共同决定, 例如医生和护士的1 级初始诊断技能为 80%, 5 级员工为 120%, 5 级诊断能再提高 50%.

**公式**:

- 最终诊断率 = 基础诊断率 * 房间加成 * 物品加成 * 返诊加成 * 研究加成 * 员工诊断技能

**例子**:

以难度中上的疾病患有 ``国王情节`` 的患者到医院就诊, 首先看看在 **最基础的情况下, 医生护士都为 1 级, 且没有物品加成, 仪器升级的情况下的诊断值**:

- 首先去全科医生办公室. 1 级无技能医生具有 80％ 的诊断技能, 在上表中, ``全科医生办公室`` 对 ``国王情结`` 的基础诊断率 20％. 所以全科医生办公室提供了: ``20％ x 80％ = 16％`` 的诊断值.
- 患者现在已被确诊 16％, 并被送到具有1级机器的综合诊断室. 在上表中, ``综合诊断室`` 对 ``国王情结`` 的基础诊断率为 12％. 所以综合诊断室提供了: ``12% * 80% = 9.6%``, 此时总诊断值为 ``16% + 9.6% = 25.6%``
- 患者现在已被确诊 25.6％, 并被送回全科医生办公室. 在表格中, 重访加成为10％, 所以重访提供了: ``10% * 80% = 8%`` 的诊断值, 此时总诊断值为 ``25.6% + 8% = 33.6%`` 完全不够看!

现在我们来计算 **医生和诊断室设施 Max 的情况下 (不算堆药柜) 的诊断室**

- 全科办公室第一次访问, 5 级医生 + 5 级全科技能 等于 120% + 75% = 195%. 在上表中, ``全科医生办公室`` 对 ``国王情结`` 的基础诊断率 20％. 所以第一次访问提供了 ``20% * 195% = 39%`` 的诊断率
- 患者前往超级磁力共振诊断室, 3 级机器提供 150% 加成, 5 级医生 + 1 级放射科, 4 级诊断提供了 120% + 40% = 160% 加成, ``超级磁力共振诊断室`` 对 ``国王情结`` 的基础诊断率为 20％. 所以该次访问提供了 ``20% * 150% * 160% = 48%``
- 重访全科办公室, 该次访问提供了: ``10% * 195% = 19.5%``, 此时总诊断值为 ``39% + 48% + 19.5% = 106.5%.

有点感觉了吗?

**结论**:

- 磁力共振诊断室对于除了 DNA 疾病之外的疾病, 诊断率碾压其他诊断室.
- 全科提供的诊断率可以靠夸张的药柜数量直接将第一次诊断结果堆到 100%.


.. _疾病的诊断和治疗数据:

疾病的诊断和治疗数据
------------------------------------------------------------------------------

.. jinja:: doc_data

    {{ doc_data.lt_disease_diagnose_and_treatment.render() }}





疾病数据分析
------------------------------------------------------------------------------

疾病总数 = 49 种

各个诊断室, 对于有多少种疾病自己为最佳诊断室. (注意, 虽然病房, 精神病室没有机器加成, 但是满级病房管理和精神病学的加成为 100%, 超过5 级诊断 50%, 最终基本持平)

- 综合诊断: 13
- 心脏病科: 16
- 体液分析: 22
- 病房: 11
- 精神科: 9
- X光: 24, 0
- 磁共振: 26
- DNA: 22

各个诊断室, 以及多少种疾病仅有自己为最佳诊断室, 也就是不造不行.

- 综合诊断: 3
- 心脏病科: 4
- 体液分析: 4

X光的诊断可以被磁共振和DNA替代, 也就是即使没有X光, 也有其他诊断室可以达到最大诊断率. **所以 X光 可以不造**.

**关于药柜**: 综合诊断, 心脏病科, 病房, 精神科, 可以放药柜增加诊断率, 体液分析, X光, 磁共振, DNA 不能放药柜.

全科最佳诊断

在最佳情况下, 医生5级全科诊断技能的医生加成为 120%+100%=220%, 3x3的全科室可以放下15个药柜家成为 115%. 总计加成为 253%. 90% / 2.53 = 35.57% 也就是说, 在医生满级的最小全科室内, 任何基础诊断率高于 35.57% 的病都可以一次全科诊断就送治疗室. 查表可知, 一次全科无法直接送治疗室的病的数量有 21 个. 其中有 立体症, 活人木乃伊化, 藏头症, 八位症 为诊所病. 而所有DNA疾病都无法一次全科直接治疗.

营销赚钱:

迅速培养 5 级治疗技能 诊所用的医生和护士的方法:

5 级治疗技能的医生护士主要用于治疗特殊病的诊所, 例如光头症等. 但是特殊病的病人数量较少, 员工不工作就无法升级. 我的解决办法是, 建造大量 光头症诊所 (3x3), 6个左右 以及 6个有害动物防治诊所 (4x4), 6个左右, 然后营销这两种病. 之所以选择这两个病是因为, ``光头症`` **的首次全科诊断基础诊断率为 90%**, 在 3x3 的最小全科室 15 药柜布局下, 配合 1 级全科诊断技能的医生就可以达到 90% * 115% * 100% = 103% 的诊断率, 从而超过 90% 一次全科直接治疗. 而 ``动物磁力症`` **的首次全科诊断基础诊断率为 80%**, 可以达到 80% * 115% * 100% = 92%. 于是你就可以在这两个房间刷医生的治疗等级了.

由于最终最赚钱的病是需要 手术室 ($20,000) 或 DNA ($12,000) 的疾病. 而这两个科室的病不是一次全科就能直接送治疗的. DNA 的病通常需要 DNA 和 磁共振, 外科(手术)病通常需要 综合诊断 和 磁共振.

DNA:

由于 DNA 病人需要去 DNA实验室 或 磁共振 二次诊断, 然后返回全科一次, 所以在布局上一个区域内需要有 全科, 磁共振, DNA实验室. 由于不算 DNA实验室 的话, 且不建造X光的情况下, 只有4种疾病是只有 磁共振 的诊断率最高的, 也就是除了 DNA 疾病之外, 还有 4 种病是肯定会跑来占用 磁共振 的. 所以建议使用 4全科

10 个 DNA 病人

- 点金术 x 2: DNA x 2
- 巨型DNA x 2: 磁共振 x 2
- 豹皮症 x 2: DNA x 1, 体液分析 x 1
- 重块症 x 2: DNA x 1, 心脏病科 x 1
- 牛仔基因

泡芙摩天楼

第二圈的 4 块地是完全对称的:


地 1 = 地 3:

- 全科 x 7
- 磁共振 x 2
- DNA x 2
- 厕所 x 2
- 咖啡厅 x 2
- 体液分析 x 1
- 员工休息室 x 1


地 2 = 地 4:

- 全科 x 4
- 磁共振 x 1
- DNA x 1
- 综合诊断 x 1
- 心脏病科 x 1
- 体液分析 x 1
- 磁共振 x 1
- DNA x 1
